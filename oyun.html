<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Umut İçin Adalet - Oyun</title>

<style>
*{
  margin:0;
  padding:0;
  box-sizing:border-box;
  user-select:none;
  -webkit-user-select:none;
  touch-action:none;
  font-family:Arial, sans-serif;
}

body{
  background:#050505;
  overflow:hidden;
}

#game{
  position:relative;
  width:100vw;
  height:100vh;
  background:radial-gradient(circle,#111,#000);
}

/* Oyuncu */
#player{
  width:40px;
  height:40px;
  border-radius:50%;
  background:#00ffcc;
  position:absolute;
  left:50%;
  top:50%;
  transform:translate(-50%,-50%);
}

/* Hedef */
.target{
  width:30px;
  height:30px;
  border-radius:50%;
  background:#00ff00;
  position:absolute;
}

/* Sayaç */
#counter{
  position:fixed;
  top:10px;
  left:50%;
  transform:translateX(-50%);
  color:white;
  font-size:18px;
  z-index:5;
}

/* Üst Tuşlar */
.top-btn{
  position:fixed;
  top:10px;
  left:10px;
  padding:8px 14px;
  background:red;
  color:white;
  border-radius:8px;
  z-index:5;
}

/* Kontroller */
.controls{
  position:fixed;
  bottom:20px;
  width:100%;
  display:flex;
  justify-content:space-between;
  padding:0 20px;
  z-index:5;
}

.left-controls,.right-controls{
  display:flex;
  flex-direction:column;
  gap:10px;
}

.key{
  width:60px;
  height:60px;
  border-radius:50%;
  background:rgba(255,255,255,0.15);
  color:white;
  font-size:26px;
  display:flex;
  align-items:center;
  justify-content:center;
}
</style>
</head>

<body>
<div id="game">

<div id="counter">Hedef: <span id="left">10</span></div>

<div id="player"></div>

<div class="top-btn" id="joystickBtn">Joystick</div>

<div class="controls" id="buttons">
  <div class="left-controls">
    <div class="key" data-dy="-1">⬆️</div>
    <div class="key" data-dy="1">⬇️</div>
  </div>

  <div class="right-controls">
    <div class="key" data-dx="-1">⬅️</div>
    <div class="key" data-dx="1">➡️</div>
  </div>
</div>

</div>

<script>
const player=document.getElementById("player");
const game=document.getElementById("game");
const leftText=document.getElementById("left");

let px=window.innerWidth/2;
let py=window.innerHeight/2;
let speedX=0,speedY=0;

let targets=[];
let total=10;
let collected=0;

leftText.innerText=total;

/* SPAWN */
function spawn(){
  const t=document.createElement("div");
  t.className="target";
  t.style.left=Math.random()*(window.innerWidth-40)+"px";
  t.style.top=Math.random()*(window.innerHeight-40)+"px";
  game.appendChild(t);
  targets.push(t);
}

/* İlk hedefler */
for(let i=0;i<5;i++) spawn();

/* GERÇEK HAREKET SİSTEMİ */
let move={left:false,right:false,up:false,down:false};

function updateSpeed(){
  speedX=(move.right-move.left)*4;
  speedY=(move.down-move.up)*4;
}

document.querySelectorAll(".key").forEach(k=>{
  const dx=k.dataset.dx;
  const dy=k.dataset.dy;

  k.addEventListener("touchstart",e=>{
    e.preventDefault();
    if(dx==1) move.right=true;
    if(dx==-1) move.left=true;
    if(dy==1) move.down=true;
    if(dy==-1) move.up=true;
    updateSpeed();
  });

  k.addEventListener("touchend",()=>{
    if(dx==1) move.right=false;
    if(dx==-1) move.left=false;
    if(dy==1) move.down=false;
    if(dy==-1) move.up=false;
    updateSpeed();
  });
});

/* OYUN LOOP */
function loop(){
  px+=speedX;
  py+=speedY;

  px=Math.max(0,Math.min(window.innerWidth-40,px));
  py=Math.max(0,Math.min(window.innerHeight-40,py));

  player.style.left=px+"px";
  player.style.top=py+"px";

  targets.forEach((t,i)=>{
    const tx=t.offsetLeft,ty=t.offsetTop;
    if(Math.abs(px-tx)<30 && Math.abs(py-ty)<30){
      t.remove();
      targets.splice(i,1);
      collected++;
      leftText.innerText=total-collected;
      if(collected<total) spawn();
    }
  });

  requestAnimationFrame(loop);
}
loop();
</script>
</body>
</html>
