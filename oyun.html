<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Umut ƒ∞√ßin Adalet - Oyun</title>

<style>
*{
  box-sizing:border-box;
  user-select:none;
  -webkit-user-select:none;
  -webkit-touch-callout:none;
}

body{
  margin:0;
  overflow:hidden;
  background:#020617;
  font-family:system-ui;
  touch-action:none;
}

#game{
  position:relative;
  width:100vw;
  height:100vh;
  overflow:hidden;
}

/* PLAYER */
#player{
  position:absolute;
  width:40px;
  height:40px;
  border-radius:50%;
  background:#22c55e;
  z-index:10;
}

/* TARGET */
.target{
  position:absolute;
  width:28px;
  height:28px;
  border-radius:50%;
  background:#ef4444;
  z-index:9;
}

/* OVERLAY */
.overlay{
  position:absolute;
  inset:0;
  background:rgba(0,0,0,.85);
  z-index:50;
  display:flex;
  align-items:center;
  justify-content:center;
  text-align:center;
  color:#fff;
}

.box{
  background:#0f172a;
  padding:25px;
  border-radius:18px;
  box-shadow:0 0 40px rgba(255,0,0,.4);
}

/* BUTTON */
.btn{
  margin-top:14px;
  padding:10px 22px;
  border-radius:14px;
  background:linear-gradient(90deg,#ff0000,#ff9900,#ff0066);
  border:none;
  color:#fff;
  font-size:16px;
  font-weight:700;
}

/* UI */
#ui{
  position:absolute;
  top:10px;
  left:10px;
  color:#fff;
  z-index:20;
  font-size:18px;
}

/* CONTROLS */
.controls{
  position:absolute;
  bottom:15px;
  width:100%;
  display:flex;
  justify-content:space-between;
  padding:0 20px;
  z-index:20;
}

.pad{
  display:grid;
  grid-template-columns:50px 50px 50px;
  grid-template-rows:50px 50px 50px;
  gap:8px;
}

.key{
  background:rgba(255,255,255,.15);
  border-radius:14px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:22px;
}

.key:active{
  background:rgba(255,255,255,.35);
}

/* JOYSTICK */
#joyArea{
  position:absolute;
  bottom:20px;
  left:50%;
  transform:translateX(-50%);
  width:160px;
  height:160px;
  background:rgba(255,0,0,.18);
  border-radius:50%;
  display:none;
  z-index:20;
}

#joy{
  position:absolute;
  width:50px;
  height:50px;
  background:#ef4444;
  border-radius:50%;
  top:55px;
  left:55px;
}

/* WIN SCREEN */
.win-rgb{
  padding:10px;
  border-radius:28px;
  background:linear-gradient(90deg,#ff0000,#ff4d4d,#ff0066,#ff0000);
  background-size:400% 400%;
  animation:winrgb 3s linear infinite;
}

@keyframes winrgb{
  0%{background-position:0%}
  100%{background-position:100%}
}

.rgb-square{
  padding:6px;
  border-radius:16px;
  background:linear-gradient(90deg,#ff0000,#ff9900,#ff0000);
  background-size:300% 300%;
  animation:winrgb 2s linear infinite;
  display:inline-block;
}

.win-text{
  margin-top:14px;
  font-size:26px;
  font-weight:900;
  background:linear-gradient(90deg,#ff0000,#ffcc00,#ff0066);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
}
</style>
</head>

<body>
<div id="game">

<div id="player"></div>

<div id="ui">üéØ Kalan: <span id="left">0</span></div>

<div class="controls" id="buttons">
  <div class="pad">
    <div></div>
    <div class="key" data-dy="-1">‚¨ÜÔ∏è</div>
    <div></div>
    <div class="key" data-dx="-1">‚¨ÖÔ∏è</div>
    <div></div>
    <div class="key" data-dx="1">‚û°Ô∏è</div>
    <div></div>
    <div class="key" data-dy="1">‚¨áÔ∏è</div>
    <div></div>
  </div>
</div>

<div id="joyArea">
  <div id="joy"></div>
</div>

<!-- START -->
<div class="overlay" id="start">
  <div class="box">
    <h2>üéÆ Oyun Ba≈ülasƒ±n</h2>
    <p>Ka√ß hedef?</p>
    <input id="count" type="number" value="5" min="1">
    <br>
    <button class="btn" onclick="start()">Ba≈üla</button>
  </div>
</div>

<!-- WIN -->
<div class="overlay" id="win" style="display:none">
  <div id="winBox"></div>
</div>

</div>

<script>
const WIN_MEDIA = "SENIN_GIF_YA_DA_VIDEO.gif";

const game=document.getElementById("game");
const player=document.getElementById("player");
const leftEl=document.getElementById("left");

let px=120,py=120;
let speedX=0,speedY=0;
let targets=[];
let total=0;
let running=false;

function start(){
  document.getElementById("start").style.display="none";
  total=parseInt(document.getElementById("count").value);
  leftEl.textContent=total;
  running=true;
  spawnBatch();
  requestAnimationFrame(loop);
}

function spawn(){
  const t=document.createElement("div");
  t.className="target";
  t.x=Math.random()*(innerWidth-30);
  t.y=Math.random()*(innerHeight-30);
  t.style.left=t.x+"px";
  t.style.top=t.y+"px";
  game.appendChild(t);
  targets.push(t);
}

function spawnBatch(){
  while(targets.length < Math.min(3,total)){
    spawn();
  }
}

function loop(){
  if(!running) return;

  px+=speedX;
  py+=speedY;

  px=Math.max(0,Math.min(innerWidth-40,px));
  py=Math.max(0,Math.min(innerHeight-40,py));

  player.style.left=px+"px";
  player.style.top=py+"px";

  targets.slice().forEach((t,i)=>{
    if(Math.abs(px-t.x)<30 && Math.abs(py-t.y)<30){
      t.remove();
      targets.splice(i,1);
      total--;
      leftEl.textContent=total;
      spawnBatch();
      if(total<=0) finish();
    }
  });

  requestAnimationFrame(loop);
}

function finish(){
  running=false;
  const box=document.getElementById("winBox");

  const media = WIN_MEDIA.endsWith(".gif")
    ? `<img src="${WIN_MEDIA}" style="width:220px;height:220px;border-radius:12px">`
    : `<video src="${WIN_MEDIA}" autoplay loop muted
        style="width:220px;height:220px;border-radius:12px"></video>`;

  box.innerHTML=`
    <div class="win-rgb">
      <div class="box">
        <div class="rgb-square">${media}</div>
        <div class="win-text">üéâ Tebrikler!<br>Kazandƒ±n</div>
        <button class="btn" onclick="location.reload()">Tekrar Ba≈üla</button>
      </div>
    </div>
  `;

  document.getElementById("win").style.display="flex";
}

/* BUTTONS */
document.querySelectorAll(".key").forEach(k=>{
  k.addEventListener("touchstart",()=>{
    speedX=(k.dataset.dx||0)*4;
    speedY=(k.dataset.dy||0)*4;
  });
  k.addEventListener("touchend",()=>{
    speedX=speedY=0;
  });
});

/* VISIBILITY RESET */
document.addEventListener("visibilitychange",()=>{
  if(document.hidden){
    sessionStorage.setItem("reload","1");
  }else if(sessionStorage.getItem("reload")){
    sessionStorage.removeItem("reload");
    location.reload();
  }
});
</script>
</body>
</html>
